@if (loading()) {
  <section class="panel p-5 text-sm text-slate-700" role="status" aria-live="polite">
    Chargement du bien...
  </section>
} @else if (error()) {
  <section class="panel border border-red-200 bg-red-50 p-5 text-sm text-red-700" role="alert">
    {{ error() }}
  </section>
} @else {
  @if (property(); as property) {
    <section class="space-y-4" aria-labelledby="property-detail-title">
      <header class="panel p-5">
        <div class="flex flex-col gap-4 lg:flex-row lg:items-start lg:justify-between">
          <div>
            <p class="text-xs font-semibold uppercase tracking-[0.2em] text-blue-600">Fiche bien</p>
            <h2 id="property-detail-title" class="mt-2 text-3xl font-semibold tracking-tight text-slate-900">
              {{ property.title }}
            </h2>
            <p class="mt-1 text-sm text-slate-500">
              {{ property.address || "Adresse non renseignee" }}, {{ property.postalCode }} {{ property.city }}
            </p>
          </div>

          <div class="flex flex-wrap items-center gap-2">
            <button
              type="button"
              class="rounded-xl bg-indigo-600 px-3 py-2 text-sm font-semibold text-white transition hover:bg-indigo-700"
              (click)="openVocalModal()"
            >
              Creer un vocal
            </button>

            <a routerLink="/app/kanban" class="rounded-xl border border-slate-300 bg-white px-3 py-2 text-sm font-semibold text-slate-700 transition hover:bg-slate-100">
              Retour pipeline
            </a>

            <button type="button" class="rounded-xl bg-blue-600 px-3 py-2 text-sm font-semibold text-white" disabled>
              {{ statusLabels[property.status] }}
            </button>

            @if (previousStatus(); as previousStatus) {
              <button
                type="button"
                class="rounded-xl bg-orange-500 px-3 py-2 text-sm font-semibold text-white transition hover:bg-orange-600"
                [disabled]="statusPending()"
                (click)="goToPreviousStatus()"
              >
                {{ statusLabels[previousStatus] }}
              </button>
            }

            @if (nextStatus(); as nextStatus) {
              <button
                type="button"
                class="rounded-xl bg-emerald-600 px-3 py-2 text-sm font-semibold text-white transition hover:bg-emerald-700"
                [disabled]="statusPending()"
                (click)="goToNextStatus()"
              >
                {{ statusLabels[nextStatus] }}
              </button>
            }

            @if (property.status !== 'ARCHIVE') {
              <button
                type="button"
                class="rounded-xl bg-slate-500 px-3 py-2 text-sm font-semibold text-white transition hover:bg-slate-600"
                [disabled]="statusPending()"
                (click)="archiveProperty()"
              >
                Archiver
              </button>
            }
          </div>
        </div>

        @if (requestFeedback()) {
          <p class="mt-4 rounded-xl bg-slate-100 px-3 py-2 text-sm text-slate-700" role="status" aria-live="polite">
            {{ requestFeedback() }}
          </p>
        }
      </header>

      <nav class="panel flex flex-wrap items-center gap-2 p-3" aria-label="Sections du dossier bien">
        <button
          type="button"
          class="rounded-xl px-3 py-2 text-sm font-semibold"
          [class.bg-blue-600]="isMainTabActive('property')"
          [class.text-white]="isMainTabActive('property')"
          [class.bg-slate-100]="!isMainTabActive('property')"
          [class.text-slate-700]="!isMainTabActive('property')"
          [attr.aria-pressed]="isMainTabActive('property') ? 'true' : 'false'"
          (click)="setMainTab('property')"
        >
          Donnees du bien
        </button>

        <button
          type="button"
          class="rounded-xl px-3 py-2 text-sm font-semibold"
          [class.bg-blue-600]="isMainTabActive('documents')"
          [class.text-white]="isMainTabActive('documents')"
          [class.bg-slate-100]="!isMainTabActive('documents')"
          [class.text-slate-700]="!isMainTabActive('documents')"
          [attr.aria-pressed]="isMainTabActive('documents') ? 'true' : 'false'"
          (click)="setMainTab('documents')"
        >
          Documents
        </button>

        <button
          type="button"
          class="rounded-xl px-3 py-2 text-sm font-semibold"
          [class.bg-blue-600]="isMainTabActive('prospects')"
          [class.text-white]="isMainTabActive('prospects')"
          [class.bg-slate-100]="!isMainTabActive('prospects')"
          [class.text-slate-700]="!isMainTabActive('prospects')"
          [attr.aria-pressed]="isMainTabActive('prospects') ? 'true' : 'false'"
          (click)="setMainTab('prospects')"
        >
          Prospects
        </button>

        <button
          type="button"
          class="rounded-xl px-3 py-2 text-sm font-semibold"
          [class.bg-blue-600]="isMainTabActive('messages')"
          [class.text-white]="isMainTabActive('messages')"
          [class.bg-slate-100]="!isMainTabActive('messages')"
          [class.text-slate-700]="!isMainTabActive('messages')"
          [attr.aria-pressed]="isMainTabActive('messages') ? 'true' : 'false'"
          (click)="setMainTab('messages')"
        >
          Messages
        </button>
      </nav>

      @if (isMainTabActive('property')) {
        <section class="panel space-y-4 p-5">
          <div class="flex items-center gap-2 overflow-x-auto pb-1">
            @for (category of propertyCategories; track category.id) {
              <button
                type="button"
                class="whitespace-nowrap rounded-xl px-3 py-2 text-sm font-semibold"
                [class.bg-blue-600]="isActivePropertyCategory(category.id)"
                [class.text-white]="isActivePropertyCategory(category.id)"
                [class.bg-slate-100]="!isActivePropertyCategory(category.id)"
                [class.text-slate-700]="!isActivePropertyCategory(category.id)"
                (click)="setActivePropertyCategory(category.id)"
              >
                {{ category.label }}
              </button>
            }
          </div>

          @if (activePropertyCategoryDefinition(); as category) {
            <div class="flex flex-wrap items-center justify-between gap-2 border-t border-slate-200 pt-4">
              <h3 class="text-xl font-semibold text-slate-900">{{ category.label }}</h3>

              <div class="flex items-center gap-2">
                @if (!isEditingActiveCategory()) {
                  <button
                    type="button"
                    class="rounded-xl bg-blue-600 px-3 py-2 text-sm font-semibold text-white transition hover:bg-blue-700"
                    (click)="startEditingActiveCategory()"
                  >
                    Modifier
                  </button>
                } @else {
                  <button
                    type="button"
                    class="rounded-xl border border-slate-300 bg-white px-3 py-2 text-sm font-semibold text-slate-700 transition hover:bg-slate-100"
                    [disabled]="patchPending()"
                    (click)="cancelEditingActiveCategory()"
                  >
                    Annuler
                  </button>

                  <button
                    type="button"
                    class="rounded-xl bg-emerald-600 px-3 py-2 text-sm font-semibold text-white transition hover:bg-emerald-700"
                    [disabled]="patchPending()"
                    (click)="saveActivePropertyCategory()"
                  >
                    {{ patchPending() ? "Enregistrement..." : "Enregistrer" }}
                  </button>
                }
              </div>
            </div>

            @if (activePropertyForm(); as form) {
              <form class="grid gap-3 sm:grid-cols-2" [formGroup]="form" novalidate>
                @for (field of category.fields; track field.key) {
                  @if (isEditingActiveCategory() || hasFieldValue(category.id, field)) {
                    <article
                      [class]="field.type === 'textarea' ? 'rounded-xl border border-slate-200 bg-slate-50 p-3 sm:col-span-2' : 'rounded-xl border border-slate-200 bg-slate-50 p-3'"
                    >
                      <p class="text-xs font-semibold uppercase tracking-[0.14em] text-slate-500">{{ field.label }}</p>

                      @if (isEditingActiveCategory()) {
                        @switch (field.type) {
                          @case ("textarea") {
                            <textarea class="field-input mt-2 min-h-24" [formControlName]="field.key"></textarea>
                          }
                          @case ("select") {
                            <select class="field-input mt-2" [formControlName]="field.key">
                              <option value="">Non renseigne</option>
                              @for (option of field.options ?? []; track option.value) {
                                <option [value]="option.value">{{ option.label }}</option>
                              }
                            </select>
                          }
                          @case ("date") {
                            <input class="field-input mt-2" type="date" [formControlName]="field.key" />
                          }
                          @default {
                            <input class="field-input mt-2" type="text" [formControlName]="field.key" />
                          }
                        }
                      } @else {
                        <p class="mt-2 text-sm text-slate-900">{{ fieldDisplayValue(category.id, field) }}</p>
                      }
                    </article>
                  }
                }
              </form>
            }
          }
        </section>
      }

      @if (isMainTabActive('documents')) {
        <section class="panel space-y-4 p-5">
          <div class="flex flex-wrap items-center justify-between gap-2">
            <h3 class="text-xl font-semibold text-slate-900">Documents par categorie</h3>
            <button
              type="button"
              class="rounded-xl bg-blue-600 px-3 py-2 text-sm font-semibold text-white transition hover:bg-blue-700"
              (click)="openUploadModal()"
            >
              Ajouter un document
            </button>
          </div>

          <div class="flex items-center gap-2 overflow-x-auto pb-1">
            @for (tab of documentTabs; track tab.id) {
              <button
                type="button"
                class="whitespace-nowrap rounded-xl px-3 py-2 text-sm font-semibold"
                [class.bg-blue-600]="isActiveDocumentTab(tab.id)"
                [class.text-white]="isActiveDocumentTab(tab.id)"
                [class.bg-slate-100]="!isActiveDocumentTab(tab.id)"
                [class.text-slate-700]="!isActiveDocumentTab(tab.id)"
                (click)="setActiveDocumentTab(tab.id)"
              >
                {{ tab.label }}
              </button>
            }
          </div>

          @if (activeDocumentTabDefinition(); as tab) {
            <div class="grid gap-4 lg:grid-cols-2">
              <article class="rounded-xl border border-slate-200 bg-slate-50 p-4">
                <h4 class="text-sm font-semibold uppercase tracking-[0.12em] text-slate-500">Documents attendus</h4>
                <ul class="mt-3 space-y-2 text-sm text-slate-700">
                  @for (expectedItem of tab.expected; track expectedItem) {
                    <li class="flex items-start gap-2">
                      <span class="mt-1 inline-block h-2 w-2 rounded-full bg-blue-500"></span>
                      <span>{{ expectedItem }}</span>
                    </li>
                  }
                </ul>
              </article>

              <article class="rounded-xl border border-slate-200 bg-slate-50 p-4">
                <h4 class="text-sm font-semibold uppercase tracking-[0.12em] text-slate-500">Documents uploades</h4>

                @if (documentsForActiveTab().length === 0) {
                  <p class="mt-3 text-sm text-slate-500">Aucun document dans cette categorie.</p>
                } @else {
                  <div class="mt-3 space-y-2">
                    @for (file of documentsForActiveTab(); track file.id) {
                      <article class="rounded-lg border border-slate-200 bg-white p-3">
                        <p class="text-sm font-semibold text-slate-900">{{ file.fileName }}</p>
                        <p class="text-xs uppercase tracking-[0.1em] text-slate-500">
                          {{ file.typeDocument || "Type inconnu" }} · {{ formatSize(file.size) }}
                        </p>
                        <p class="mt-1 text-xs text-slate-500">Statut: {{ file.status }}</p>
                      </article>
                    }
                  </div>
                }
              </article>
            </div>
          }

          @if (uploadFeedback()) {
            <p class="rounded-xl bg-slate-100 px-3 py-2 text-sm text-slate-700" role="status" aria-live="polite">
              {{ uploadFeedback() }}
            </p>
          }
        </section>
      }

      @if (isMainTabActive('prospects')) {
        <section class="panel space-y-4 p-5">
          <div class="flex flex-wrap items-center justify-between gap-2">
            <h3 class="text-xl font-semibold text-slate-900">Prospects du bien</h3>
            <button
              type="button"
              class="rounded-xl bg-blue-600 px-3 py-2 text-sm font-semibold text-white transition hover:bg-blue-700"
              (click)="openProspectModal()"
            >
              Ajouter un prospect
            </button>
          </div>

          @if (prospectFeedback()) {
            <p class="rounded-xl bg-slate-100 px-3 py-2 text-sm text-slate-700" role="status" aria-live="polite">
              {{ prospectFeedback() }}
            </p>
          }

          @if (prospects().length === 0) {
            <p class="text-sm text-slate-600">Aucun prospect enregistre.</p>
          } @else {
            <section class="overflow-x-auto rounded-xl border border-slate-200">
              <table class="min-w-full border-collapse text-sm">
                <thead class="bg-slate-100 text-left text-xs font-semibold uppercase tracking-[0.12em] text-slate-600">
                  <tr>
                    <th class="px-4 py-3">Nom</th>
                    <th class="px-4 py-3">Email</th>
                    <th class="px-4 py-3">Telephone</th>
                    <th class="px-4 py-3">Lien</th>
                  </tr>
                </thead>
                <tbody>
                  @for (prospect of prospects(); track prospect.id) {
                    <tr class="border-t border-slate-200 align-top">
                      <td class="px-4 py-3">
                        <p class="font-semibold text-slate-900">{{ prospectDisplayName(prospect) }}</p>
                        <p class="mt-1 text-xs text-slate-500">{{ prospectRelationLabel(prospect.relationRole) }}</p>
                      </td>
                      <td class="px-4 py-3 text-slate-700">{{ prospect.email || "Non renseigne" }}</td>
                      <td class="px-4 py-3 text-slate-700">{{ prospect.phone || "Non renseigne" }}</td>
                      <td class="px-4 py-3">
                        <a [routerLink]="['/app/utilisateurs', prospect.userId]" class="text-slate-800 transition hover:text-blue-700">
                          Voir utilisateur
                        </a>
                      </td>
                    </tr>
                  }
                </tbody>
              </table>
            </section>
          }
        </section>
      }

      @if (isMainTabActive('messages')) {
        <section class="panel space-y-4 p-5">
          <h3 class="text-xl font-semibold text-slate-900">Messages rattaches</h3>

          @if (messages().length === 0) {
            <p class="text-sm text-slate-600">Aucun message lie a ce bien.</p>
          } @else {
            <div class="space-y-3">
              @for (message of messages(); track message.id) {
                <article class="rounded-2xl border border-slate-200 bg-white p-3">
                  <p class="text-xs uppercase tracking-[0.12em] text-slate-500">
                    {{ message.channel }} · {{ message.receivedAt | date: 'short' }}
                  </p>
                  <p class="mt-1 font-semibold text-slate-900">{{ message.subject || "Sans objet" }}</p>
                  <p class="text-sm text-slate-600">{{ message.body }}</p>
                  <p class="mt-1 text-xs font-semibold text-slate-500">IA: {{ message.aiStatus }}</p>
                </article>
              }
            </div>
          }
        </section>
      }
    </section>

    @if (vocalModalOpen()) {
      <div
        class="fixed inset-0 z-40 flex items-center justify-center bg-slate-950/45 p-4"
        role="dialog"
        aria-modal="true"
        aria-labelledby="vocal-modal-title"
        (click)="onVocalBackdropClick($event)"
      >
        <div class="w-full max-w-lg rounded-2xl border border-slate-200 bg-white p-5 shadow-xl">
          <div class="flex items-start justify-between gap-2">
            <h3 id="vocal-modal-title" class="text-xl font-semibold text-slate-900">Creer un vocal</h3>
            <button
              type="button"
              class="rounded-lg border border-slate-300 px-2 py-1 text-xs font-semibold text-slate-700 transition hover:bg-slate-100"
              [disabled]="vocalPending()"
              (click)="closeVocalModal()"
            >
              Fermer
            </button>
          </div>

          <div class="mt-4 space-y-3">
            <p class="rounded-xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs text-slate-600">
              Enregistrement depuis votre micro puis envoi automatique au backend avec le lien vers ce bien.
            </p>

            <div class="flex flex-wrap items-center gap-2">
              @if (!vocalRecording()) {
                <button
                  type="button"
                  class="rounded-xl bg-emerald-600 px-3 py-2 text-sm font-semibold text-white transition hover:bg-emerald-700"
                  [disabled]="vocalPending()"
                  (click)="startVocalRecording()"
                >
                  Demarrer l'enregistrement
                </button>
              } @else {
                <button
                  type="button"
                  class="rounded-xl bg-red-600 px-3 py-2 text-sm font-semibold text-white transition hover:bg-red-700"
                  (click)="stopVocalRecording()"
                >
                  Arreter
                </button>
              }

              @if (recordedVocal()) {
                <button
                  type="button"
                  class="rounded-xl border border-slate-300 bg-white px-3 py-2 text-sm font-semibold text-slate-700 transition hover:bg-slate-100"
                  [disabled]="vocalPending()"
                  (click)="clearRecordedVocal()"
                >
                  Recommencer
                </button>
              }
            </div>

            @if (recordedVocalLabel()) {
              <p class="text-sm text-slate-700">{{ recordedVocalLabel() }}</p>
            }

            @if (vocalFeedback()) {
              <p class="rounded-xl bg-slate-100 px-3 py-2 text-sm text-slate-700" role="status" aria-live="polite">
                {{ vocalFeedback() }}
              </p>
            }

            <div class="flex items-center justify-end gap-2 pt-1">
              <button
                type="button"
                class="rounded-xl border border-slate-300 bg-white px-3 py-2 text-sm font-semibold text-slate-700 transition hover:bg-slate-100"
                [disabled]="vocalPending()"
                (click)="closeVocalModal()"
              >
                Annuler
              </button>
              <button
                class="rounded-xl bg-indigo-600 px-3 py-2 text-sm font-semibold text-white transition hover:bg-indigo-700"
                type="button"
                [disabled]="vocalPending() || vocalRecording() || !recordedVocal()"
                (click)="uploadVocalRecording()"
              >
                {{ vocalPending() ? "Envoi..." : "Envoyer le vocal" }}
              </button>
            </div>
          </div>
        </div>
      </div>
    }

    @if (uploadModalOpen()) {
      <div
        class="fixed inset-0 z-40 flex items-center justify-center bg-slate-950/45 p-4"
        role="dialog"
        aria-modal="true"
        aria-labelledby="upload-modal-title"
        (click)="onUploadBackdropClick($event)"
      >
        <div class="w-full max-w-lg rounded-2xl border border-slate-200 bg-white p-5 shadow-xl">
          <div class="flex items-start justify-between gap-2">
            <h3 id="upload-modal-title" class="text-xl font-semibold text-slate-900">Ajouter un document</h3>
            <button
              type="button"
              class="rounded-lg border border-slate-300 px-2 py-1 text-xs font-semibold text-slate-700 transition hover:bg-slate-100"
              (click)="closeUploadModal()"
            >
              Fermer
            </button>
          </div>

          <form class="mt-4 space-y-3" [formGroup]="uploadForm" (ngSubmit)="uploadFile()" novalidate>
            <div>
              <label class="field-label" for="upload-type">Type de document</label>
              <select id="upload-type" class="field-input" formControlName="typeDocument">
                @for (typeDocument of activeDocumentTabDefinition().typeDocuments; track typeDocument) {
                  <option [value]="typeDocument">{{ typeDocument }}</option>
                }
              </select>
            </div>

            <div>
              <label class="field-label" for="upload-file">Fichier</label>
              <input id="upload-file" class="field-input" type="file" (change)="onFileInputChange($event)" />
              @if (selectedFileName()) {
                <p class="mt-1 text-xs text-slate-500">{{ selectedFileName() }}</p>
              }
            </div>

            @if (uploadFeedback()) {
              <p class="rounded-xl bg-slate-100 px-3 py-2 text-sm text-slate-700" role="status" aria-live="polite">
                {{ uploadFeedback() }}
              </p>
            }

            <div class="flex items-center justify-end gap-2 pt-1">
              <button
                type="button"
                class="rounded-xl border border-slate-300 bg-white px-3 py-2 text-sm font-semibold text-slate-700 transition hover:bg-slate-100"
                (click)="closeUploadModal()"
              >
                Annuler
              </button>

              <button class="rounded-xl bg-blue-600 px-3 py-2 text-sm font-semibold text-white transition hover:bg-blue-700" type="submit" [disabled]="uploadPending()">
                {{ uploadPending() ? "Upload..." : "Ajouter" }}
              </button>
            </div>
          </form>
        </div>
      </div>
    }

    @if (prospectModalOpen()) {
      <div
        class="fixed inset-0 z-40 flex items-center justify-center bg-slate-950/45 p-4"
        role="dialog"
        aria-modal="true"
        aria-labelledby="prospect-modal-title"
        (click)="onProspectBackdropClick($event)"
      >
        <div class="w-full max-w-2xl rounded-2xl border border-slate-200 bg-white p-5 shadow-xl">
          <div class="flex items-start justify-between gap-2">
            <h3 id="prospect-modal-title" class="text-xl font-semibold text-slate-900">Ajouter un prospect</h3>
            <button
              type="button"
              class="rounded-lg border border-slate-300 px-2 py-1 text-xs font-semibold text-slate-700 transition hover:bg-slate-100"
              (click)="closeProspectModal()"
            >
              Fermer
            </button>
          </div>

          <form class="mt-4 space-y-3" [formGroup]="prospectForm" (ngSubmit)="addProspect()" novalidate>
            <div class="flex flex-wrap gap-2">
              <button
                type="button"
                class="rounded-xl px-3 py-2 text-sm font-semibold"
                [class.bg-blue-600]="prospectMode() === 'existing'"
                [class.text-white]="prospectMode() === 'existing'"
                [class.bg-slate-100]="prospectMode() !== 'existing'"
                [class.text-slate-700]="prospectMode() !== 'existing'"
                [attr.aria-pressed]="prospectMode() === 'existing' ? 'true' : 'false'"
                (click)="setProspectMode('existing')"
              >
                Client existant
              </button>
              <button
                type="button"
                class="rounded-xl px-3 py-2 text-sm font-semibold"
                [class.bg-blue-600]="prospectMode() === 'new'"
                [class.text-white]="prospectMode() === 'new'"
                [class.bg-slate-100]="prospectMode() !== 'new'"
                [class.text-slate-700]="prospectMode() !== 'new'"
                [attr.aria-pressed]="prospectMode() === 'new' ? 'true' : 'false'"
                (click)="setProspectMode('new')"
              >
                Nouveau client
              </button>
            </div>

            @if (prospectMode() === 'existing') {
              <div>
                <label class="field-label" [for]="prospectAutocompleteId">Client</label>
                <div
                  #prospectLookupContainer
                  class="relative"
                  role="combobox"
                  aria-haspopup="listbox"
                  [attr.aria-expanded]="prospectSuggestionsOpen() ? 'true' : 'false'"
                  [attr.aria-owns]="prospectAutocompleteListId"
                  [attr.aria-controls]="prospectAutocompleteListId"
                  (focusout)="onProspectLookupContainerFocusOut($event, prospectLookupContainer)"
                >
                  <input
                    [id]="prospectAutocompleteId"
                    class="field-input pr-11"
                    type="text"
                    formControlName="existingLookup"
                    placeholder="Nom ou email d'un client"
                    autocomplete="off"
                    [attr.aria-autocomplete]="'list'"
                    [attr.aria-controls]="prospectAutocompleteListId"
                    (focus)="onProspectLookupFocus()"
                    (input)="onProspectLookupInput($event)"
                  />
                  <button
                    type="button"
                    class="absolute right-2 top-1/2 -translate-y-1/2 rounded-md border border-slate-300 bg-white px-2 py-1 text-xs text-slate-600 transition hover:bg-slate-100"
                    aria-label="Afficher les clients"
                    (click)="toggleProspectSuggestions()"
                  >
                    ▾
                  </button>

                  @if (prospectSuggestionsOpen()) {
                    <ul
                      [id]="prospectAutocompleteListId"
                      class="absolute z-20 mt-1 max-h-56 w-full overflow-auto rounded-xl border border-slate-200 bg-white p-1 shadow-lg"
                      role="listbox"
                      tabindex="-1"
                    >
                      @for (client of filteredProspectClients(); track client.id) {
                        <li role="option" [attr.aria-selected]="prospectForm.controls.userId.value === client.id ? 'true' : 'false'">
                          <button
                            type="button"
                            class="w-full rounded-lg px-3 py-2 text-left text-sm text-slate-700 transition hover:bg-slate-100"
                            (mousedown)="onProspectSuggestionMouseDown($event)"
                            (click)="selectProspectClient(client)"
                          >
                            {{ prospectOptionLabel(client) }}
                          </button>
                        </li>
                      } @empty {
                        <li class="px-3 py-2 text-sm text-slate-500">Aucun client trouve.</li>
                      }
                    </ul>
                  }
                </div>
                @if (clientsLoading()) {
                  <p class="mt-1 text-xs text-slate-500">Chargement des clients...</p>
                }
              </div>
            } @else {
              <div class="grid gap-3 sm:grid-cols-2">
                <div>
                  <label class="field-label" for="prospect-first-name">Prenom</label>
                  <input id="prospect-first-name" class="field-input" type="text" formControlName="firstName" />
                </div>
                <div>
                  <label class="field-label" for="prospect-last-name">Nom</label>
                  <input id="prospect-last-name" class="field-input" type="text" formControlName="lastName" />
                </div>
                <div>
                  <label class="field-label" for="prospect-phone">Telephone</label>
                  <input id="prospect-phone" class="field-input" type="text" formControlName="phone" />
                </div>
                <div>
                  <label class="field-label" for="prospect-email">Email</label>
                  <input id="prospect-email" class="field-input" type="email" formControlName="email" />
                </div>
                <div class="sm:col-span-2">
                  <label class="field-label" for="prospect-address">Adresse</label>
                  <input id="prospect-address" class="field-input" type="text" formControlName="address" />
                </div>
                <div>
                  <label class="field-label" for="prospect-postal">Code postal</label>
                  <input id="prospect-postal" class="field-input" type="text" formControlName="postalCode" />
                </div>
                <div>
                  <label class="field-label" for="prospect-city">Ville</label>
                  <input id="prospect-city" class="field-input" type="text" formControlName="city" />
                </div>
              </div>
            }

            @if (prospectFeedback()) {
              <p class="rounded-xl bg-slate-100 px-3 py-2 text-sm text-slate-700" role="status" aria-live="polite">
                {{ prospectFeedback() }}
              </p>
            }

            <div class="flex items-center justify-end gap-2 pt-1">
              <button
                type="button"
                class="rounded-xl border border-slate-300 bg-white px-3 py-2 text-sm font-semibold text-slate-700 transition hover:bg-slate-100"
                (click)="closeProspectModal()"
              >
                Annuler
              </button>
              <button
                class="rounded-xl bg-blue-600 px-3 py-2 text-sm font-semibold text-white transition hover:bg-blue-700"
                type="submit"
                [disabled]="prospectPending()"
              >
                {{ prospectPending() ? "Ajout..." : "Ajouter" }}
              </button>
            </div>
          </form>
        </div>
      </div>
    }
  }
}
